// Container usage and permission
docker {
  enabled      = true
  runOptions   = '--platform linux/amd64 -u root:$(id -g)'
  fixOwnership = true
}


/*
                Configuration of Docker usage
                DO NOT change any of those
*/

// specific images
process {
    
    // small container with tools used to set-up databases
    withLabel: 'db_download|db_tools|misc' {
      container = 'fmalmeida/bacannot:misc_tools'
    }

    // container for prokka
    withName: 'PROKKA' {
      container = 'quay.io/biocontainers/prokka:1.14.6--pl5262hdfd78af_1'
    }

    // container for mlst
    withName: 'MLST' {
      container = 'quay.io/biocontainers/mlst:2.19.0--hdfd78af_1'
    }

    // container for barrnap
    withName: 'BARRNAP' {
      container = 'quay.io/biocontainers/barrnap:0.9--hdfd78af_4'
    }

    // plasmidfinder container
    withName: 'PLASMIDFINDER' {
      container = 'quay.io/biocontainers/plasmidfinder:2.1.1--hdfd78af_1'
    }

    // platon container
    withName: 'PLATON' {
      container = 'quay.io/biocontainers/platon:1.6--pyhdfd78af_1'
    }

    // islandPath dimob container
    withName: 'ISLANDPATH' {
      container = 'quay.io/biocontainers/islandpath:1.0.6--hdfd78af_0'

      // it generally fails without any reason on the first time
      errorStrategy = 'retry'
      maxRetries    = 5
    }

    // phigaro container
    withName: 'PHIGARO' {
      container = 'quay.io/biocontainers/phigaro:2.3.0--pyh7b7c402_1'
    }

    // phispy container
    withName: 'PHISPY' {
      container = 'quay.io/biocontainers/phispy:4.2.19--py39h7cff6ad_0'
    }

    // kofamscan container
    withName: 'KOFAMSCAN' {
      container = 'quay.io/biocontainers/kofamscan:1.3.0--hdfd78af_2'

      // it generally fails without any reason on the first time
      errorStrategy = 'retry'
      maxRetries    = 2
    }

    // phispy container
    withName: 'AMRFINDER' {
      container = 'quay.io/biocontainers/ncbi-amrfinderplus:3.10.18--h17dc2d4_0'
    }

    // phispy container
    withName: 'CARD_RGI' {
      container = 'quay.io/biocontainers/rgi:5.2.1--pyhdfd78af_1'
    }

    // withLabel: 'renv' {
    //     container = 'fmalmeida/bacannot:v3.0_renv'
    // }

    // withLabel: 'jbrowse' {
    //     container = 'fmalmeida/bacannot:jbrowse'
    // }

    // withLabel: 'kofam' {
    //     container = 'fmalmeida/bacannot:kofamscan'
    // }

    // withLabel: 'smash' {
    //     container = 'fmalmeida/bacannot:antismash'
    // }

    // withLabel: 'unicycler' {
    //     container = 'quay.io/biocontainers/unicycler:0.4.8--py38h8162308_3'
    // }

    // withLabel: 'flye' {
    //     container = 'quay.io/biocontainers/flye:2.9--py39h39abbe0_0'
    // }
}

